---
title: "Biorentention plots"
author: "Dave Costello"
date: "5/10/2018"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

logaxis = function(minlog,maxlog,side){
  pow <- seq(minlog,maxlog,by=1)
  ticksat <- as.vector(sapply(pow, function(p) (1:10)*10^p))
  axis(side, 10^pow,las=1)
  axis(side, ticksat, labels=NA, tcl=-0.25, lwd=0, lwd.ticks=1)
}

```



#Data import
```{r}
soilchem <- read.csv(file="soil_metal_NEW.csv")
soilchem$Cell_no <- factor(soilchem$Cell_no)
summary(soilchem)

#Outliers
soilchem[soilchem$Sample=="30a",'Zn'] <- NA
soilchem[soilchem$Sample=="12a",'Cu'] <- NA

cell <- read.csv(file="cell_data_NEW.csv")
cell$Location_name <- as.character(cell$Location_name)
summary(cell)

#Merge both datasets
fullsoil <- merge(soilchem,cell[,c(2:10)],by="Cell_no")
summary(fullsoil)

```


###Bioretention cell size
```{r cell v. drain size}
par(pin=c(2.5,2.5))
plot(Cell_area~Drain_area,data=cell,log="xy",ylim=c(10,10000),xlim=c(100,10000),xaxt="n",yaxt="n",
     xlab=expression("Drainage basin area (m"^2*")"),ylab=expression("Bioretention cell area (m"^2*")"),
     pch=16,cex=1.3)
logaxis(2,4,1)
logaxis(1,4,2)
abline(log10(1/5),1,lwd=2) #Ideal size of cell 1/5 the size of drain area
points(100,345,pch=21,cex=1) #Cell with no drainage area
#dev.copy(pdf,'cellsize.pdf')
#dev.off()
```

###Soil metals through time
```{r metal through time}
par(pin=c(3,1.5),mfrow=c(3,1),mai=c(0.2,1,0.2,1))
plot(Zn~Age,data=fullsoil,log="y",xlab="",ylab=expression("Soil Zn (mg kg"^-1*")"),yaxt="n",ylim=c(10,1000),xaxt="n")
axis(1,labels=F)
logaxis(1,3,2)

par(mai=c(0.2,1,0.2,1))
plot(Pb~Age,data=fullsoil,log="y",xlab="",ylab=expression("Soil Pb (mg kg"^-1*")"),yaxt="n",ylim=c(5,1000),xaxt="n")
axis(1,labels=F)
logaxis(1,3,2)

par(mai=c(1,1,0.2,1))
plot(Cu~Age,data=fullsoil,log="y",xlab="Age (yr)",ylab=expression("Soil Cu (mg kg"^-1*")"),yaxt="n",ylim=c(5,1000))
logaxis(0,3,2)

#dev.copy(pdf,'cellmetal.pdf')
#dev.off()
```
